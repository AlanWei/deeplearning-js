import train from './train';

test('train', () => {
  const ro = train(
    [[1, 1, 1], [1, 1, 1], [1, 1, 1]],
    [[1, 1, 0]],
    {
      W1: [[1, 1, 1], [1, 1, 1], [1, 1, 1]],
      b1: [[0, 0, 0], [0, 0, 0], [0, 0, 0]],
      activation1: 'relu',
      W2: [[1, 1, 1]],
      b2: [[0, 0, 0]],
      activation2: 'sigmoid',
    },
    "cross-entropy",
    0.005,
    100,
    10,
  );
  expect(ro.costs).toEqual([
    { "cost": 3.000123402189504, "epoch": 1 },
    { "cost": 2.444335515707496, "epoch": 10 },
    { "cost": 1.9236466648888537, "epoch": 20 },
    { "cost": 1.4908991471053739, "epoch": 30 },
    { "cost": 1.14124732250916, "epoch": 40 },
    { "cost": 0.8788591076050484, "epoch": 50 },
    { "cost": 0.7063979185079626, "epoch": 60 },
    { "cost": 0.6100490648188893, "epoch": 70 },
    { "cost": 0.5621151678810197, "epoch": 80 },
    { "cost": 0.5379460417115286, "epoch": 90 },
    { "cost": 0.5235682292490217, "epoch": 100 },
  ]);
  expect(ro.parameters.W1).toEqual([
    [0.8105190973738057, 0.8105190973738057, 0.8105190973738057],
    [0.8105190973738057, 0.8105190973738057, 0.8105190973738057],
    [0.8105190973738057, 0.8105190973738057, 0.8105190973738057],
  ]);
  expect(ro.parameters.W2).toEqual([[
    0.14727924102167664,
    0.14727924102167664,
    0.14727924102167664,
  ]]);
  expect(ro.parameters.b1).toEqual([
    [0.009859758719048418, 0.009859758719048418, -0.2092004200642915],
    [0.009859758719048418, 0.009859758719048418, -0.2092004200642915],
    [0.009859758719048418, 0.009859758719048418, -0.2092004200642915],
  ]);
  expect(ro.parameters.b2).toEqual([
    [0.04465398798500956, 0.04465398798500956, -0.4341635153508487],
  ]);
});