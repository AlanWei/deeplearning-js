import backPropagation from './backPropagation';

test('backPropagation', () => {
  const ro = backPropagation(
    "cross-entropy",
    {
      "activationFuncs": ["relu", "sigmoid"],
      "caches": [
        {
          "activationCache": [[3, 3, 3], [3, 3, 3], [3, 3, 3]],
          "linearCache": {
            "A": [[1, 1, 1], [1, 1, 1], [1, 1, 1]],
            "W": [[1, 1, 1], [1, 1, 1], [1, 1, 1]],
            "b": [[0, 0, 0], [0, 0, 0], [0, 0, 0]],
          }
        },
        {
          "activationCache": [[9, 9, 9]],
          "linearCache": {
            "A": [[3, 3, 3], [3, 3, 3], [3, 3, 3]],
            "W": [[1, 1, 1]],
            "b": [[0, 0, 0]],
          }
        },
      ],
      "yHat": [[0.9998766054240137, 0.9998766054240137, 0.9998766054240137]],
    },
    [[1, 1, 1]],
  );
  expect(ro.dA1).toEqual([
    [-0.0003701837279589393, -0.0003701837279589393, -0.0003701837279589393],
    [-0.0003701837279589393, -0.0003701837279589393, -0.0003701837279589393],
    [-0.0003701837279589393, -0.0003701837279589393, -0.0003701837279589393]
  ]);
  expect(ro.dA2).toEqual([
    [-0.0001233945759863131, -0.0001233945759863131, -0.0001233945759863131],
    [-0.0001233945759863131, -0.0001233945759863131, -0.0001233945759863131],
    [-0.0001233945759863131, -0.0001233945759863131, -0.0001233945759863131]
  ]);
  expect(ro.dW1).toEqual([
    [-0.0003701837279589393, -0.0003701837279589393, -0.0003701837279589393],
    [-0.0003701837279589393, -0.0003701837279589393, -0.0003701837279589393],
    [-0.0003701837279589393, -0.0003701837279589393, -0.0003701837279589393]
  ]);
  expect(ro.dW2).toEqual([
    [-0.0011105511838768178, -0.0011105511838768178, -0.0011105511838768178]
  ]);
  expect(ro.db1).toEqual([
    [-0.0001233945759863131, -0.0001233945759863131, -0.0001233945759863131],
    [-0.0001233945759863131, -0.0001233945759863131, -0.0001233945759863131],
    [-0.0001233945759863131, -0.0001233945759863131, -0.0001233945759863131]
  ]);
  expect(ro.db2).toEqual([
    [-0.0001233945759863131, -0.0001233945759863131, -0.0001233945759863131]
  ]);
});